version: "2.1"
#networks:
#  default:
services:
  homeassistant:
    image: lscr.io/linuxserver/homeassistant:latest
#    networks:
#      - default
#    container_name: homeassistant
    network_mode: host
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Los_Angeles
    volumes:
      - ./homeassistant/config:/config
#    ports:
#      - 8123:8123 #optional
#    devices:
#      - /path/to/device:/path/to/device #optional
    restart: unless-stopped

  mosquitto:
    image: eclipse-mosquitto
#    container_name: mosquitto
#    networks:
#      - default
#    network_mode: host
    environment:
#      - PUID=1000
#      - PGID=1000
      - TZ=America/Los_Angeles
#    user: 1000:1000
    user: 1883:1883
    ports:
      - 1883:1883
      - 9001:9001
    volumes:
#      - ./mosquitto/conf:/mosquitto/conf
#      - ./mosquitto/conf/mosquitto.conf:/mosquitto/conf/mosquitto.conf
#      - ./mosquitto/data:/mosquitto/data
#      - ./mosquitto/log:/mosquitto/log
      - /home/ubuntu/docker/hass/mosquitto/config:/mosquitto/config
      - /home/ubuntu/docker/hass/mosquitto/data:/mosquitto/data
      - /home/ubuntu/docker/hass/mosquitto/log:/mosquitto/log

  zigbee2mqtt:
#    container_name: zigbee2mqtt
    image: koenkk/zigbee2mqtt
#    networks:
#      - default
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Los_Angeles
    restart: unless-stopped
    volumes:
      - ./zigbee2mqtt/data:/app/data
      - /run/udev:/run/udev:ro
    ports:
      # Frontend port
      - 8989:8989
    environment:
      - TZ=America/Los_Angeles
    devices:
      # Make sure this matched your adapter location
      - /dev/ttyUSB0:/dev/ttyACM0
